<!DOCTYPE html>
<html lang="en-au" dir="ltr">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>🍹GinAI - Cocktails mixed with generative AI &middot; Simon Aubury</title>
  <meta name="description" content="Cocktails mixed with generative AI" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://simonaubury.com/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://simonaubury.com/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://simonaubury.com/favicon-16x16.png">
  <link href="https://simonaubury.com/css/katex.min.css" rel="stylesheet">
  
  
  
  
  <link href="https://simonaubury.com/css/concated.min.css" rel="stylesheet">
  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7N67PMRZ6N"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-7N67PMRZ6N', { 'anonymize_ip': false });
}
</script>

  
</head>

  <body class="single-body">
    <nav class="nav-bar side-padding">
  <h1 class="nav-header"><a href="https://simonaubury.com/" class="nav-text">simon aubury</a></h1>
  <div class="hamburger-menu">
    <input class="hamburger-menu-button" type="checkbox"
      onclick="hamburgerMenuPressed.call(this)"
      aria-label="Hamburger Menu Button"
    >
    <div class="hamburger-menu-icon">
      <span></span>
      <span></span>
    </div>
    <ul id="menu" class="hamburger-menu-overlay">
      <li><a href="https://simonaubury.com/" class="hamburger-menu-overlay-link">Home</a></li>
      <li><a href="https://simonaubury.com/slides/" class="hamburger-menu-overlay-link">Presentation slides</a></li>
      <li><a href="https://simonaubury.com/about-me/" class="hamburger-menu-overlay-link">About Simon</a></li>
      
      <li><a href="https://simonaubury.com/categories/cat/" class="hamburger-menu-overlay-link">Cat</a></li>
      
      <li><a href="https://simonaubury.com/categories/cdc/" class="hamburger-menu-overlay-link">CDC</a></li>
      
      <li><a href="https://simonaubury.com/categories/duckdb/" class="hamburger-menu-overlay-link">duckdb</a></li>
      
      <li><a href="https://simonaubury.com/categories/flink/" class="hamburger-menu-overlay-link">flink</a></li>
      
      <li><a href="https://simonaubury.com/categories/generativeai/" class="hamburger-menu-overlay-link">GenerativeAI</a></li>
      
      <li><a href="https://simonaubury.com/categories/gpt/" class="hamburger-menu-overlay-link">GPT</a></li>
      
      <li><a href="https://simonaubury.com/categories/homeassistant/" class="hamburger-menu-overlay-link">homeassistant</a></li>
      
      <li><a href="https://simonaubury.com/categories/kafka/" class="hamburger-menu-overlay-link">Kafka</a></li>
      
      <li><a href="https://simonaubury.com/categories/ml/" class="hamburger-menu-overlay-link">ML</a></li>
      
      <li><a href="https://simonaubury.com/categories/raspberry-pi/" class="hamburger-menu-overlay-link">Raspberry Pi</a></li>
      
      <li><a href="https://simonaubury.com/categories/snowflake/" class="hamburger-menu-overlay-link">snowflake</a></li>
      
      <li><a href="https://simonaubury.com/index.xml" class="hamburger-menu-overlay-link">rss</a></li>
    </ul>
  </div>
</nav>

    <main class="content side-text-padding">
      <article class="post dropcase">
        <header class="post-header">
          <h1 class="post-title">🍹GinAI - Cocktails mixed with generative AI</h1>
          <p class="post-date">Posted <time datetime="2023-10-18">Oct 18, 2023</time></p>
        </header>
        <picture class="post-figure">
          
          
          
          <source srcset="https://simonaubury.com/posts/202310_ginai/00000000_hu6c7b6bd2da020e68922bd20bf9233b9f_321817_711x0_resize_lanczos_3.png 1x, https://simonaubury.com/posts/202310_ginai/00000000_hu6c7b6bd2da020e68922bd20bf9233b9f_321817_1422x0_resize_lanczos_3.png 2x, https://simonaubury.com/posts/202310_ginai/00000000_hu6c7b6bd2da020e68922bd20bf9233b9f_321817_2133x0_resize_lanczos_3.png 3x">
          <img src="https://simonaubury.com/posts/202310_ginai/00000000_hu6c7b6bd2da020e68922bd20bf9233b9f_321817_711x0_resize_lanczos_3.png" >
        </picture>
        
        
        <h1 id="ginai---cocktails-mixed-with-generative-ai">🍹GinAI - Cocktails mixed with generative AI</h1>
<p>GinAI — a robotic bartender which can make a nice drink given a random collection of juices, mixers and spirits. Real cocktails created and music chosen by OpenAI — all mixed by a RaspberryPi bartender.</p>
<p><img src="./00000000.png" alt="GinAI — Cocktails mixed with generative AI and a RaspberryPi."></p>
<h2 id="im-bored--can-i-get-a-video">I’m bored — can I get a video?</h2>
<p>Here’s a quick video of GinAI in action.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/EWsBKTsAg1w" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h2 id="starting-at-the-end">Starting at the end</h2>
<p>Let me describe the finished project — and we can work backwards on how I built 🍹GinAI🍸. The GinAI bartender uses up to four ingredients — and when I press the dispense button, OpenAI <a href="https://chat.openai.com/">ChatGPT</a> will “create” a drink, describe the cocktail creation and select an appropriate song 🎵.</p>
<p>A row of decorative lights look pretty during the creation and flash 🚨once the cocktail is ready. A Google Nest Mini is used as the speaker for both the spoken words 🗣️ and for playing the tunes 🎶.</p>
<p><img src="./00000001.gif" alt=""></p>
<h2 id="cocktail-inspiration-from-chatgpt">Cocktail inspiration from ChatGPT</h2>
<p>I started my cocktail mixing adventure by simply asking OpenAI for a cocktail recipe from the random spirits and mixers I had available. For example, I prompted <a href="https://chat.openai.com/">ChatGPT</a> to suggest a cocktail with this query</p>
<blockquote>
<p>create a cocktail from the ingredients gin, tequila, apple juice and tonic.</p>
</blockquote>
<p>Which returns a helpful cocktail mixing recipe along with text instructions as a response.</p>
<p><img src="./00000002.png" alt="First experiment with ChatGPT console"><em>First experiment with ChatGPT console</em></p>
<p>I quickly found a few limitations with my initial cocktail creations from the console.</p>
<ul>
<li>
<p>OpenAI would sometime suggest a cocktail with an ingredients I didn’t specify (and didn’t have). I corrected this with the added instruction to only use ingredients from the provided list. Results were more reliable with prompt instructions “You do not need to use all of the ingredients. You may only use a maximum of 4 ingredients.” I can now call myself a prompt engineer 😀</p>
</li>
<li>
<p>Recipe suggestions used a variety of measurement unit — such as fluid ounce “a dash of” or other bizarre imperial measurement. I could coerce the output by simply adding the prompt “Only give quantities in metric units. Only give quantities in whole numbers”.</p>
</li>
<li>
<p>There was no consistency with the total volume of cocktail produced. Some may not consider 2 litres of alcohol a problem — but at the very least it overflowed my available cocktail glassware. The prompt instruction to limit to a 250 millilitre volume reduced spillage and excessive drinking</p>
</li>
</ul>
<p>With the prompt creation giving reasobale results, I moved onto building a reliable interface.</p>
<h2 id="predictable-openai-responses-with-function-calling">Predictable OpenAI responses with function calling</h2>
<p>The cocktail recipes created by ChatGPT were going to drive the automated drink dispensing — so I needed ensure OpenAI API would generate a predicable schema for the JSON responses. OpenAI recently added <a href="https://openai.com/blog/function-calling-and-other-api-updates">**Function calling</a>** functionality to their API, which I could use to return a consistent JSON response. Function calling is primarily aimed at connecting GPT’s capabilities with external tools and APIs — and converts queries such as “Email Alice to see if she wants to get coffee next Friday” to a function call like <strong>send_email(to: string, body: string)</strong>.</p>
<p>I didn’t need to direct function calling, but I can use the technique (along with a dummy function) to ensure recipes suggested by OpenAI ChatGPT meet a my specification. Enforcing a predictable JSON output means the directions can be easily parsed and implemented by the RaspberryPi liquid dispensing pumps to make yummy cocktails based on the response from a <code>[gpt-3.5-turbo](https://platform.openai.com/docs/models/gpt-3-5)</code> model.</p>
<p>The easiest implementation I found was to use a <a href="https://docs.pydantic.dev">PyDantic</a> class for my target schema — and use that as a parameter for the method call to “<strong>ChatCompletion.create()</strong>”. Here’s a fragment of the <a href="https://github.com/saubury/GinAI/blob/master/ginai_types.py">GinAI Python classes</a> used.</p>
<pre><code># create a PyDantic schema for output
class Ingredient(BaseModel):
ingredient_name: str
quantity_ml: int

class Cocktail(BaseModel):
cocktail_name: str
description: str
inventor: str
matching_song: str
instructions: str
ingredients: list[Ingredient]
</code></pre>
<p>This is a basic class, where an <strong>Ingredient</strong> class is the ingredient name and a quantity specified in millilitres. The <strong>Cocktail</strong> class has a list of the Ingredient objects, along with the name, description and appropriate song to compliment the drinking of the coctail</p>
<p>I followed <a href="https://medium.com/dev-bits/a-clear-guide-to-openai-function-calling-with-python-dcbc200c5d70">this guide</a> as a great tutorial for using the new function calling feature from OpenAI to enforce a structured output from GPT models.</p>
<p>The OpenAI Python calling logic looks like this (or see the <a href="https://github.com/saubury/GinAI/blob/master/openai_util.py">whole openai_util.py module</a>).</p>
<pre><code>completion = openai.ChatCompletion.create( 
    model='gpt-3.5-turbo',
    messages=[
        {'role': 'system', 'content': 'You are a helpful bartender.'},
        {'role': 'user', 'content': prompt},
    ],
    functions=[
        {
        'name': 'get_answer_for_user_query',
        'description': 'Get user answer in series of steps',
        'parameters': Cocktail.model_json_schema()
        }
    ],
    function_call={'name': 'get_answer_for_user_query'}
)
</code></pre>
<p>OpenAI function calling ensured created recipes conformed to a strict JSON schema. For example, a typical response would look like this.</p>
<pre><code>{
    &quot;cocktail_name&quot;: &quot;Summer Breeze&quot;,
    &quot;description&quot;: &quot;A refreshing cocktail perfect for a hot day.&quot;,
    &quot;inventor&quot;: &quot;My Bartender&quot;,
    &quot;matching_song&quot;: &quot;Summertime by DJ Jazzy Jeff &amp; The Fresh Prince&quot;,
    &quot;instructions&quot;: &quot;1. Fill a glass with ice.\n2. Combine the ingredients in the glass.\n3. Stir well.\n4. Garnish with a slice of orange.\n5. Enjoy!&quot;,
    &quot;ingredients&quot;: [
        {
            &quot;ingredient_name&quot;: &quot;gin&quot;,
            &quot;quantity_ml&quot;: 45
        },
        {
            &quot;ingredient_name&quot;: &quot;orange juice&quot;,
            &quot;quantity_ml&quot;: 60
        },
        {
            &quot;ingredient_name&quot;: &quot;tonic&quot;,
            &quot;quantity_ml&quot;: 15
        }
    ]
}
</code></pre>
<p>With cocktail recipes consistently created, I could move onto building the drink dispensing hardware.</p>
<h2 id="ginai--hardware-build">GinAI — Hardware build</h2>
<p>With the interfaces and software roughed out to imagine cocktails, the next job was to build the pouring hardware.</p>
<h2 id="pumps">Pumps</h2>
<p>I used 4 <a href="https://en.wikipedia.org/wiki/Peristaltic_pump">peristaltic pumps</a> to provide a “food safe” way to pump the liquids from the drink bottles. These pumps provide a steady rate of flow of liquids when powered. By carefully timing the “on” time for the pump I can precisely deliver the ideal amount of spirits or mixers for the perfect 🍸</p>
<p><img src="./00000003.jpeg" alt="A quick search on AliExpress"><em>A quick search on AliExpress</em></p>
<p>The pumps are pretty cheap — and provide an accurate way to dispense precise quantities of liquids.</p>
<p><img src="./00000004.jpeg" alt="Pumps — straight from the post"><em>Pumps — straight from the post</em></p>
<p>The pumps are mounted on a basic wooden frame higher than the tallest bottle. My children helped to build the frame, labelling and installing the pumps.</p>
<p><img src="./00000005.jpeg" alt="The important task of adding labels to pumps"><em>The important task of adding labels to pumps</em></p>
<p>A view from the rear show the placement of pumps and liquids. A manual electrical switch allow the pumps to be run independently from the Raspberry Pi (helpful for cleaning).</p>
<p><img src="./00000006.jpeg" alt="Rear view of Cocktail maker"><em>Rear view of Cocktail maker</em></p>
<p>The pumps use 12 volt motors. To operate them via the Raspberry Pi I used a <a href="https://www.jaycar.com.au/arduino-compatible-4-channel-12v-relay-module/p/XC4440">4 Channel 12V Relay Module</a>. This allows the pumps to be switched on and off independently with the 5 volt signals from the <a href="https://www.raspberrypi.org/documentation/usage/gpio/">GPIO pins</a> of the Raspberry Pi.</p>
<p><img src="./00000007.jpeg" alt="Relay board"><em>Relay board</em></p>
<p>The Raspberry Pi is mounted with the relay board. The relays switch 12 volt power on and off for the pump motors. The signals for the relay board are taken directly from the GPIO header of the Raspberry Pi.</p>
<p><img src="./00000008.png" alt="Board placement"><em>Board placement</em></p>
<p>Finally I added the mandatory RGB LED’s for some colourful lighting effects. I used a row of <a href="https://www.jaycar.com.au/duinotech-arduino-compatible-w2812b-rgb-led-strip-2m/p/XC4390">WS2812B LED strip</a>. This was installed behind the final collecting tube with a bit of soldering hidden by white heat shrink tubing.</p>
<p><img src="./00000009.png" alt="WS2812B RGB LED strip."></p>
<p>A great bartended needs to be able to talk and entertain, so GinAI needed a speaker. I used a Google Nest Mini mounted to the frame as a speaker for spoken words and for playing the music.</p>
<p><img src="./00000010.png" alt="Google Nest Mini"><em>Google Nest Mini</em></p>
<h2 id="-cheers">🍹 Cheers!</h2>
<p>With a bit of coding and a <em>lot</em> of trust in my GinAI bartender I’m enjoying the surprising world of generative created cocktails</p>
<p><img src="./00000011.png" alt="Cheers"><em>Cheers</em></p>
<h2 id="-code">🛠️ Code</h2>
<p>The code for GinAI is available at</p>
<ul>
<li><a href="https://github.com/saubury/GinAI/">https://github.com/saubury/GinAI/</a></li>
</ul>

      </article>
      
    </main>
    <nav class="end-nav side-padding">
      
      <a ontouchstart="cardPressed.call(this)" ontouchend="cardReleased.call(this)" ontouchmove="cardReleased.call(this)" 
  href="https://simonaubury.com/posts/202309_paranoid_genai/" class="card blog-card bc-next" rel="bookmark" >
  
  <div class="card-img-container">
    <p class="card-img-overlay">Next Article</p>
    <picture>
      
      
      
      <source srcset="https://simonaubury.com/posts/202309_paranoid_genai/00000001_hu074179da6abb53be1247ad3607aa30fe_229407_400x0_resize_lanczos_3.png 1x, https://simonaubury.com/posts/202309_paranoid_genai/00000001_hu074179da6abb53be1247ad3607aa30fe_229407_800x0_resize_lanczos_3.png 2x, https://simonaubury.com/posts/202309_paranoid_genai/00000001_hu074179da6abb53be1247ad3607aa30fe_229407_1200x0_resize_lanczos_3.png 3x">
      <img src="https://simonaubury.com/posts/202309_paranoid_genai/00000001_hu074179da6abb53be1247ad3607aa30fe_229407_400x0_resize_lanczos_3.png" class="card-img" >
    </picture>
  </div>
  
  <article class="card-body">
    <h2 class="card-title">My data, your LLM</h2>
    <p class="card-text">Paranoid analysis of iMessage chats with OpenAI, LlamaIndex &amp; DuckDB</p>
    <div class="card-subtext muted-text">
      <p>Posted <time datetime="2023-09-10">Sep 10, 2023</time></p>
      <p>#GenerativeAI #duckdb </p>
    </div>
  </article>
</a>
      
    </nav>
    <footer class="side-padding" style="background-image: url('https://simonaubury.com/img/home-blob-flip.svg');">
    <a href="https://simonaubury.com/" class="footer-link">
    
        <img class="footer-icon" src="https://simonaubury.com/icons/home.svg" alt="Home">
    
    </a>
    
    
    
    <a href="https://github.com/saubury" class="footer-link" target="_blank" rel="noopener noreferrer">
    
        <img class="footer-icon" src="https://simonaubury.com/icons/github.svg" alt="GitHub"/>
    
    </a>
    
    
    
    <a href="https://www.linkedin.com/in/simonaubury" class="footer-link" target="_blank" rel="noopener noreferrer">
    
        <img class="footer-icon" src="https://simonaubury.com/icons/linkedin.svg" alt="LinkedIn"/>
    
    </a>
    
    
    <a href="https://simonaubury.com/index.xml" class="footer-link" target="_blank" rel="noopener noreferrer">
    
        <img class="footer-icon" src="https://simonaubury.com/icons/rss.svg" alt="RSS"/>
    
    </a>
    
    
    
    
    
    
    
    
</footer>
    
  <script defer src="https://simonaubury.com/js/katex.min.js"></script>


  <script defer src="https://simonaubury.com/js/auto-render.min.js" onload="renderMathInElement(document.body);"></script>


<script src="https://simonaubury.com/js/core.min.js"></script>

  </body>
</html>
